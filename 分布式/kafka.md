## 概念

1. AMQP

​	Advanced Message Queuing Protocol

​	提供统一消息服务的应用层标准高级消息队列协议\

​	rabbitmq是其中一个实现



2. Kafa

   **特点**

   1. 流式处理
   2. 天生分布式
   3. 存储数据(磁盘)

​     **术语**

![image-20220818162049061](assets/image-20220818162049061.png)

![image-20220818162103853](assets/image-20220818162103853.png)

![image-20220818163024781](assets/image-20220818163024781.png)

 1. 消息(数据单元,记录)-字节数组,可以把它看作数据库表中某一行的记录

 2. 批次: 为了提高效率， 消息会 分批次 写入 Kafka，批次就代指的**是一组消息**

 3. 主题:消息的**种类**称为 `主题`（Topic）,可以说一个主题代表了一类消息。相当于是对消息进行分类。主题就像是数据库中的表。

 4. 分区:主题可以被分为若干个分区（partition），同一个主题中的分区可以不在一个机器上，有可能会部署在多个机器上，由此来实现 kafka 的`伸缩性`，单一主题中的分区有序，但是无法保证主题中所有的分区有序

    也就是防止某个topic对应的消息过多(压力过大),可能导致吞吐瓶颈

 5. 生产者(发布者) 消费者(订阅者)

 6. 偏移量 元数据,不断递增的整数值

 7. 消费者群组

    一个partition只能被一个消费者消费;

    一个消费者能消费多个partition

    Rebalance

 8. broker  一个独立的 Kafka 服务器就被称为broker,broker 接收来自生产者的消息，为消息设置偏移量，并提交消息到磁盘保存;消费者消费

 9. 重平衡：Rebalance。消费者组内某个消费者实例挂掉后，其他消费者实例自动重新分配订阅主题分区的过程。Rebalance 是 Kafka 消费者端实现高可用的重要手段。

 10. broker 集群：broker 是`集群` 的组成部分，broker 集群由一个或多个 broker 组成，每个集群都有一个 broker 同时充当了`集群控制器`的角色（自动从集群的活跃成员中选举出来,也就是broker leader

 11. 副本：Kafka 中**消息的备份又叫做 `副本`（Replica）**，副本的数量是可以配置的，Kafka 定义了两类副本：领导者副本（Leader Replica） 和 追随者副本（Follower Replica），前者对外提供服务，后者只是被动跟随。



**补充**

持久化 默认策略(7天  1G)





# 为什么选择kafka

![image-20220818163501970](assets/image-20220818163501970.png)



# 安装和配置

![image-20220818165420436](assets/image-20220818165420436.png)

需要用到zk集群

用到的版本是2.11-2.3.0

https://archive.apache.org/dist/kafka/2.3.0/kafka_2.11-2.3.0.tgz

2.11代表scala版本 scala是一种编程语言

Scala 是 Scalable Language 的简写，是一门多范式(范式/编程方式[面向对象/函数式编程])的编程语言,以java虚拟机（JVM）为运行环境

